# Day 17 - 정규화 NF

## 정규화
- 삽입/수정/삭제의 이상 현상을 제거
- 데이터의 중복 최소화
- 대부분 3차 정규화까지만 진행
> 맨 처음에 table을 설계하려면 column같은걸 서로에 대한 관계를 잘 이해해야 한다.
### 1차 정규화 (1NF)
- 하나의 컬럼에 값이 1개씩만 있어야한다.
- 반복적인 컬럼값이 나타나는 경우

        ex) 
            상품명
            바지1, 바지2, 바지3
            검색이 힘들다..

        - 정규화진행
        
            상품명
            바지1
            바지2
            바지3
    > 하나의 컬럼에 값을 여러개를 넣는 경우 -> 열이 아니라 행을 여러개 만들어 해결
### 2차 정규화 (2NF)
- 테이블의 모든 컬럼이 서로 관계가 있어야한다.
- 모든 컬럼이 서로 관계가 없는 경우
    
        ex)
            user
            이름    나이    상품명
            한동석  10      바지
            홍길동  11      치마
            이순신  2       자켓

        - 정규화진행
            user
            이름    나이
            한동석  10 
            홍길동  11
            이순신 12

            product
            나이    상품명
    > table에 뜬금없는 column 이 들어가 있는 경우 -> 하나의 테이블에는 서로 관련있는 것끼리 묶어주는게 좋다.

### 3차 정규화 (3NF)
- 하나의 컬럼이 다른 컬럼을 대표할 수 없다.

        ex)
            이름    시  구  동  우편번호
            한동석  남양주  화도읍  구암리  12345
            홍길동  서울시  관악    봉천    44332

            우편번호로 시, 구, 동을 알 수 있다.
            중복된 데이터가 생길 가능성이 있다.

            - 정규화진행
            이름    우편번호
            한동석  12345
            홍길동  44332

            우편번호    시  구  동
            01234   남양주  화도읍  구암리
            44332   서울    관악    봉천
    > 하나의 column 이 다른 column 을 의미하는 경우 -> 묶어버리기

## 데이터베이스에서 정규화가 필요한이유?
- 데이터베이스를 잘못 설계하면 불필요한 데이터 중복으로 인해 공간이 낭비된다. (이러한 현상을 Anomaly라고한다)

        ex)
        회원번호와 프로젝트코드 두 컬럼의 조합키(두개이상의 PK)로 설정되어있는 테이블이고 한사람은 하나의 부서만 가질 수 있다.

        회원번호    이름    부서    프로젝트코드    급여    부서별명수
        21060601    한동석  개발팀  ABC0001         3000    4   
        21060601    한동석  개발팀  CBA1112         2000    4
        210605601    한동석  개발팀  EFG9991        4000    4
        21060505    홍길동  기획팀  HIJ8282         5000    2
        21060507    이순신  디자인팀    MNO3000     7000    3

        => 정규화를 하지않으면 이러한 이상한 table이 만들어짐.
            `이상현상 발생`

### 이상현상의 종류
- 삽입 이상
    - 새데이터를 삽입하기 위해 불필요한 데이터도 삽입해야하는 문제
    - ex) 담당 프로젝트가 정해지지 않은 사원이 있다면, 프로젝트 코드에 NULL을 작성할 수 없으므로 이 사원은 테이블에 추가될 수 없다. 따라서 '미정'이라는 프로젝트 코드를 따로 만들어 삽입해야한다.

- 갱신 이상
    - 중복 행 중 일부만 변경하여 데이터가 불일치하게 되면 모순의 문제
    - ex) 한명의 사원은 반드시 하나의 부서에만 속 할 수 있다.
        만약 "한동석"이 보안팀으로 부서를 옮길 시 3개 모두 갱신해주지 않는다면 개발팀인지 보안팀인지 알 수 없다.

- 삭제 이상
    - 행을 삭제하면 꼭 필요한 데이터까지 함께 삭제되는 문제
    - ex) 이순신이 담당한 프로젝트를 박살내서 프로젝트가 드랍된다면 이순신행을 모두 삭제하게된다. -> 이순신이라는 사람도 사라진다
        따라서 프로젝트에서 드랍되면 정보를 모두 드랍하게된다.

    이러한 이상현상이 발생하는 이유는 테이블이 정규화가 되어있지 않기 때문이다. 정규화를 진행하기 위해서는 각 column간의 관련성을 파악해야하고, 이 관련성을 **"함수적 종속성"(Functional Dependency)** 이라고한다.
    > 따라서 하나의 테이블에서는 하나의 함수적 종속성만 존재하도록 정규화를 한다.

        ex) 
        함수 
        X->Y (X가 Y로 함수적 종속성을 띈다면)

        X: 결정자 (X가 Y를 결정한다)
        Y: 종속자 (Y가 X에 종속되어있다)

